<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Resume Evaluation Report - NextHire.AI</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    
    <!-- Print-friendly styles -->
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f8f9fa;
        }
        
        .report-container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            padding: 40px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .report-header {
            text-align: center;
            border-bottom: 3px solid #007bff;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .report-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #dee2e6;
            border-radius: 8px;
        }
        
        .section-title {
            font-size: 1.3rem;
            font-weight: bold;
            color: #007bff;
            margin-bottom: 15px;
            border-bottom: 2px solid #007bff;
            padding-bottom: 10px;
        }
        
        .score-badge {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 1.5rem;
            font-weight: bold;
            margin: 10px 0;
        }
        
        .badge-ready {
            background-color: #28a745;
            color: white;
        }
        
        .badge-partial {
            background-color: #ffc107;
            color: black;
        }
        
        .badge-not-ready {
            background-color: #dc3545;
            color: white;
        }
        
        .chart-image {
            max-width: 100%;
            height: auto;
            margin: 20px 0;
            border: 1px solid #dee2e6;
            border-radius: 8px;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .info-label {
            font-weight: bold;
            color: #495057;
        }
        
        .info-value {
            color: #212529;
        }
        
        .skills-list {
            list-style-type: none;
            padding-left: 0;
        }
        
        .skills-list li {
            padding: 5px 0;
            padding-left: 20px;
            position: relative;
        }
        
        .skills-list li:before {
            content: "â€¢";
            position: absolute;
            left: 0;
            color: #007bff;
            font-weight: bold;
        }
        
        .no-print {
            text-align: center;
            margin-top: 30px;
        }
        
        @media print {
            body {
                background-color: white;
                padding: 0;
            }
            
            .report-container {
                box-shadow: none;
                padding: 20px;
            }
            
            .no-print {
                display: none;
            }
            
            .chart-image {
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>

<div class="report-container">
    <!-- Report Header -->
    <div class="report-header">
        <h1>Resume Evaluation Report</h1>
        <p class="text-muted">NextHire.AI - Placement Readiness Analysis</p>
    </div>
    
    <!-- Resume Details Section -->
    {% if resume_data %}
    <div class="report-section">
        <div class="section-title">
            <i class="bi bi-person-circle"></i> Resume Details
        </div>
        
        <div class="info-row">
            <span class="info-label">Name:</span>
            <span class="info-value">{{ resume_data.name }}</span>
        </div>
        
        <div class="info-row">
            <span class="info-label">Email:</span>
            <span class="info-value">{{ resume_data.email }}</span>
        </div>
        
        <div class="info-row">
            <span class="info-label">Phone:</span>
            <span class="info-value">{{ resume_data.phone }}</span>
        </div>
        
        <div class="info-row">
            <span class="info-label">Degree:</span>
            <span class="info-value">{{ resume_data.degree }}</span>
        </div>
        
        <div class="info-row">
            <span class="info-label">CGPA:</span>
            <span class="info-value">{{ resume_data.cgpa }}</span>
        </div>
        
        {% if resume_data.city %}
        <div class="info-row">
            <span class="info-label">City:</span>
            <span class="info-value">{{ resume_data.city }}</span>
        </div>
        {% endif %}
        
        {% if resume_data.github_username %}
        <div class="info-row">
            <span class="info-label">GitHub:</span>
            <span class="info-value">{{ resume_data.github_username }}</span>
        </div>
        {% endif %}
        
        <div class="info-row">
            <span class="info-label">Skills:</span>
            <span class="info-value">{{ resume_data.skills }}</span>
        </div>
    </div>
    {% endif %}
    
    <!-- Resume Score Section -->
    <div class="report-section">
        <div class="section-title">
            <i class="bi bi-graph-up"></i> Resume Evaluation Score
        </div>
        
        <div class="text-center">
            <div class="score-badge 
                {% if readiness_status == 'Ready' %}badge-ready
                {% elif readiness_status == 'Partially Ready' %}badge-partial
                {% else %}badge-not-ready{% endif %}">
                {{ resume_score }} / 100
            </div>
            
            <p class="mt-3">
                <strong>Readiness Status:</strong> 
                <span class="
                    {% if readiness_status == 'Ready' %}text-success
                    {% elif readiness_status == 'Partially Ready' %}text-warning
                    {% else %}text-danger{% endif %}">
                    {{ readiness_status }}
                </span>
            </p>
        </div>
    </div>
    
    <!-- Missing Skills Section -->
    <div class="report-section">
        <div class="section-title">
            <i class="bi bi-exclamation-triangle"></i> Skill Gap Analysis
        </div>
        
        {% if missing_skills and missing_skills|length > 0 %}
        <p><strong>Skills to Improve:</strong></p>
        <ul class="skills-list">
            {% for skill in missing_skills %}
            <li>{{ skill }}</li>
            {% endfor %}
        </ul>
        {% else %}
        <p class="text-success">
            <i class="bi bi-check-circle"></i> 
            <strong>No missing skills detected. You are fully eligible for this role.</strong>
        </p>
        {% endif %}
    </div>
    
    <!-- Job-Specific Evaluation Section -->
    {% if job_title != "Not Selected" %}
    <div class="report-section">
        <div class="section-title">
            <i class="bi bi-briefcase"></i> Job-Specific Evaluation
        </div>
        
        <div class="info-row">
            <span class="info-label">Job Title:</span>
            <span class="info-value">{{ job_title }}</span>
        </div>
        
        <div class="info-row">
            <span class="info-label">Company:</span>
            <span class="info-value">{{ job_company }}</span>
        </div>
        
        <div class="info-row">
            <span class="info-label">Job Fit Score:</span>
            <span class="info-value">{{ job_fit_score }} / 100</span>
        </div>
        
        <!-- FEATURE 2: ELIGIBILITY BADGE -->
        <div class="info-row">
            <span class="info-label">Eligibility Status:</span>
            <span class="info-value">
                {% if job_fit_score >= 70 %}
                    <span class="badge bg-success">Eligible</span>
                {% elif job_fit_score >= 40 %}
                    <span class="badge bg-warning text-dark">Partially Eligible</span>
                {% else %}
                    <span class="badge bg-danger">Not Eligible</span>
                {% endif %}
            </span>
        </div>
    </div>
    {% endif %}
    
    <!-- ========== NEW SECTION 1: ROLE BASED EVALUATION SYSTEM ========== -->
    <div class="report-section" style="background-color: #e7f3ff; border: 2px solid #0066cc;">
        <div class="section-title" style="color: #0066cc;">
            <i class="bi bi-bullseye"></i> Role Based Evaluation System
        </div>
        
        {% if job_title != "Not Selected" and job_fit_score > 0 %}
        <div class="info-row">
            <span class="info-label">Selected Role:</span>
            <span class="info-value"><strong>{{ job_title }}</strong></span>
        </div>
        
        <div class="info-row">
            <span class="info-label">Company:</span>
            <span class="info-value"><strong>{{ job_company }}</strong></span>
        </div>
        
        <div class="info-row">
            <span class="info-label">Job Fit Score:</span>
            <span class="info-value">
                <span class="score-badge" style="font-size: 1.2rem; padding: 5px 15px;
                    {% if job_fit_score >= 70 %}background-color: #28a745;
                    {% elif job_fit_score >= 50 %}background-color: #ffc107; color: black;
                    {% else %}background-color: #dc3545;{% endif %}">
                    {{ job_fit_score }} / 100
                </span>
            </span>
        </div>
        
        <div class="info-row">
            <span class="info-label">Role Readiness Status:</span>
            <span class="info-value">
                <strong class="
                    {% if role_readiness_status == 'Ready for Role' %}text-success
                    {% elif role_readiness_status == 'Partially Ready' %}text-warning
                    {% else %}text-danger{% endif %}">
                    {{ role_readiness_status }}
                </strong>
            </span>
        </div>
        
        {% if missing_skills and missing_skills|length > 0 %}
        <div class="mt-3">
            <p><strong>Role-Specific Missing Skills:</strong></p>
            <ul class="skills-list">
                {% for skill in missing_skills %}
                <li>{{ skill }}</li>
                {% endfor %}
            </ul>
            <p class="text-muted small mt-2">
                <i class="bi bi-info-circle"></i> Focus on these skills to improve your fit for this specific role.
            </p>
        </div>
        {% else %}
        <div class="mt-3 p-3" style="background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 5px;">
            <p class="text-success mb-0">
                <i class="bi bi-check-circle"></i> 
                <strong>Excellent! You have all the required skills for this role.</strong>
            </p>
        </div>
        {% endif %}
        
        {% else %}
        <div class="text-center p-4" style="background-color: #fff3cd; border: 1px solid #ffc107; border-radius: 5px;">
            <i class="bi bi-info-circle" style="font-size: 2rem; color: #856404;"></i>
            <p class="mt-2 mb-0" style="color: #856404;">
                <strong>Role not selected for evaluation.</strong><br>
                <small>Select a job role during resume evaluation to see role-specific analysis.</small>
            </p>
        </div>
        {% endif %}
    </div>
    
    <!-- ========== NEW SECTION 2: SKILL GAP LEARNING ROADMAP ========== -->
    <div class="report-section" style="background-color: #fff8e1; border: 2px solid #ff9800;">
        <div class="section-title" style="color: #e65100;">
            <i class="bi bi-map"></i> Skill Gap Learning Roadmap
        </div>
        
        {% if skill_roadmap and skill_roadmap.total_skills > 0 %}
        <p class="mb-3">
            <strong>Structured learning path to bridge your skill gaps:</strong>
        </p>
        
        <!-- Phase 1: Core Missing Skills -->
        {% if skill_roadmap.phase1|length > 0 %}
        <div class="mb-4 p-3" style="background-color: #ffebee; border-left: 4px solid #f44336; border-radius: 5px;">
            <h6 style="color: #c62828; margin-bottom: 10px;">
                <i class="bi bi-1-circle-fill"></i> Phase 1: Core Missing Skills (Priority: High)
            </h6>
            <ul class="skills-list">
                {% for skill in skill_roadmap.phase1 %}
                <li><strong>{{ skill }}</strong> - Start learning immediately</li>
                {% endfor %}
            </ul>
            <p class="text-muted small mb-0">
                <i class="bi bi-clock"></i> Recommended timeline: 1-3 months
            </p>
        </div>
        {% endif %}
        
        <!-- Phase 2: Intermediate Enhancement -->
        {% if skill_roadmap.phase2|length > 0 %}
        <div class="mb-4 p-3" style="background-color: #fff3e0; border-left: 4px solid #ff9800; border-radius: 5px;">
            <h6 style="color: #e65100; margin-bottom: 10px;">
                <i class="bi bi-2-circle-fill"></i> Phase 2: Intermediate Enhancement (Priority: Medium)
            </h6>
            <ul class="skills-list">
                {% for skill in skill_roadmap.phase2 %}
                <li><strong>{{ skill }}</strong> - Learn after Phase 1</li>
                {% endfor %}
            </ul>
            <p class="text-muted small mb-0">
                <i class="bi bi-clock"></i> Recommended timeline: 3-6 months
            </p>
        </div>
        {% endif %}
        
        <!-- Phase 3: Advanced Optimization -->
        {% if skill_roadmap.phase3|length > 0 %}
        <div class="mb-4 p-3" style="background-color: #e8f5e9; border-left: 4px solid #4caf50; border-radius: 5px;">
            <h6 style="color: #2e7d32; margin-bottom: 10px;">
                <i class="bi bi-3-circle-fill"></i> Phase 3: Advanced Optimization (Priority: Low)
            </h6>
            <ul class="skills-list">
                {% for skill in skill_roadmap.phase3 %}
                <li><strong>{{ skill }}</strong> - Learn for advanced proficiency</li>
                {% endfor %}
            </ul>
            <p class="text-muted small mb-0">
                <i class="bi bi-clock"></i> Recommended timeline: 6+ months
            </p>
        </div>
        {% endif %}
        
        <div class="mt-3 p-3" style="background-color: #e3f2fd; border: 1px solid #2196f3; border-radius: 5px;">
            <p class="mb-0" style="color: #1565c0;">
                <i class="bi bi-lightbulb-fill"></i> 
                <strong>Pro Tip:</strong> Focus on Phase 1 skills first. Master them through projects and practice before moving to Phase 2.
            </p>
        </div>
        
        {% else %}
        <div class="text-center p-4" style="background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 5px;">
            <i class="bi bi-trophy-fill" style="font-size: 2rem; color: #155724;"></i>
            <p class="mt-2 mb-0" style="color: #155724;">
                <strong>Congratulations! You are fully aligned with this role.</strong><br>
                <small>Continue practicing real-world projects and stay updated with industry trends.</small>
            </p>
        </div>
        {% endif %}
    </div>
    
    <!-- ========== NEW SECTION 3: ROLE SWITCH IMPACT ANALYSIS ========== -->
    <div class="report-section" style="background-color: #f3e5f5; border: 2px solid #9c27b0;">
        <div class="section-title" style="color: #6a1b9a;">
            <i class="bi bi-arrow-left-right"></i> Role Switch Impact Analysis
        </div>
        
        {% if role_impact %}
        <p class="mb-3">
            <strong>Comparison between your general resume strength and role-specific fit:</strong>
        </p>
        
        <div class="row mb-3">
            <div class="col-md-6">
                <div class="p-3" style="background-color: white; border: 2px solid #007bff; border-radius: 8px; text-align: center;">
                    <p class="mb-1 text-muted small">Resume Score</p>
                    <p class="mb-0" style="font-size: 2rem; font-weight: bold; color: #007bff;">
                        {{ role_impact.resume_score }}
                    </p>
                </div>
            </div>
            <div class="col-md-6">
                <div class="p-3" style="background-color: white; border: 2px solid #28a745; border-radius: 8px; text-align: center;">
                    <p class="mb-1 text-muted small">Job Fit Score</p>
                    <p class="mb-0" style="font-size: 2rem; font-weight: bold; color: #28a745;">
                        {{ role_impact.job_fit_score }}
                    </p>
                </div>
            </div>
        </div>
        
        <div class="info-row">
            <span class="info-label">Score Difference:</span>
            <span class="info-value">
                <strong style="font-size: 1.2rem; 
                    {% if role_impact.difference > 0 %}color: #dc3545;
                    {% elif role_impact.difference < 0 %}color: #28a745;
                    {% else %}color: #007bff;{% endif %}">
                    {% if role_impact.difference > 0 %}+{% endif %}{{ role_impact.difference }} points
                </strong>
            </span>
        </div>
        
        <div class="info-row">
            <span class="info-label">Impact Level:</span>
            <span class="info-value">
                <span class="badge 
                    {% if role_impact.impact_level == 'Significant' %}bg-danger
                    {% elif role_impact.impact_level == 'Moderate' %}bg-warning text-dark
                    {% else %}bg-success{% endif %}" style="font-size: 1rem;">
                    {{ role_impact.impact_level }}
                </span>
            </span>
        </div>
        
        <div class="mt-3 p-3" style="background-color: white; border: 1px solid #dee2e6; border-radius: 5px;">
            <p class="mb-0">
                <i class="bi bi-info-circle-fill" style="color: #6a1b9a;"></i> 
                <strong>Analysis:</strong> {{ role_impact.message }}
            </p>
        </div>
        
        <div class="mt-3 p-3" style="background-color: #e1f5fe; border: 1px solid #0288d1; border-radius: 5px;">
            <p class="mb-2"><strong>Interpretation Guide:</strong></p>
            <ul class="mb-0" style="font-size: 0.9rem;">
                <li><strong>Difference &gt; 20:</strong> Significant role mismatch - consider upskilling or exploring better-fit roles</li>
                <li><strong>Difference 10-20:</strong> Moderate gap - focus on role-specific skills to improve alignment</li>
                <li><strong>Difference &lt; 10:</strong> Strong alignment - you're on the right track!</li>
            </ul>
        </div>
        
        {% else %}
        <div class="text-center p-4" style="background-color: #fff3cd; border: 1px solid #ffc107; border-radius: 5px;">
            <i class="bi bi-info-circle" style="font-size: 2rem; color: #856404;"></i>
            <p class="mt-2 mb-0" style="color: #856404;">
                <strong>Role comparison not available.</strong><br>
                <small>Select a job role during evaluation to see impact analysis.</small>
            </p>
        </div>
        {% endif %}
    </div>
    
    <!-- ========== NEW SECTION 4: RESUME STRENGTH BREAKDOWN ========== -->
    <div class="report-section" style="background-color: #fce4ec; border: 2px solid #e91e63;">
        <div class="section-title" style="color: #c2185b;">
            <i class="bi bi-pie-chart-fill"></i> Resume Strength Breakdown
        </div>
        
        {% if resume_breakdown_data %}
        <p class="mb-3">
            <strong>Detailed analysis of your resume components:</strong>
        </p>
        
        <!-- Section Scores -->
        <div class="row mb-3">
            <!-- Education -->
            <div class="col-md-6 mb-3">
                <div class="p-3" style="background-color: white; border-radius: 8px; border: 2px solid 
                    {% if resume_breakdown_data.sections.education.percentage >= 80 %}#28a745
                    {% elif resume_breakdown_data.sections.education.percentage >= 60 %}#ffc107
                    {% else %}#dc3545{% endif %};">
                    <h6 style="margin-bottom: 10px;">
                        <i class="bi bi-mortarboard-fill"></i> Academic Strength
                    </h6>
                    <div class="d-flex justify-content-between align-items-center">
                        <span style="font-size: 1.5rem; font-weight: bold;">
                            {{ resume_breakdown_data.sections.education.score }}/{{ resume_breakdown_data.sections.education.max_score }}
                        </span>
                        <span class="badge" style="font-size: 1rem; background-color: 
                            {% if resume_breakdown_data.sections.education.percentage >= 80 %}#28a745
                            {% elif resume_breakdown_data.sections.education.percentage >= 60 %}#ffc107
                            {% else %}#dc3545{% endif %};">
                            {{ resume_breakdown_data.sections.education.percentage }}%
                        </span>
                    </div>
                    <p class="text-muted small mb-0 mt-2">{{ resume_breakdown_data.sections.education.details }}</p>
                </div>
            </div>
            
            <!-- Skills -->
            <div class="col-md-6 mb-3">
                <div class="p-3" style="background-color: white; border-radius: 8px; border: 2px solid 
                    {% if resume_breakdown_data.sections.skills.percentage >= 80 %}#28a745
                    {% elif resume_breakdown_data.sections.skills.percentage >= 60 %}#ffc107
                    {% else %}#dc3545{% endif %};">
                    <h6 style="margin-bottom: 10px;">
                        <i class="bi bi-code-slash"></i> Technical Skills Strength
                    </h6>
                    <div class="d-flex justify-content-between align-items-center">
                        <span style="font-size: 1.5rem; font-weight: bold;">
                            {{ resume_breakdown_data.sections.skills.score }}/{{ resume_breakdown_data.sections.skills.max_score }}
                        </span>
                        <span class="badge" style="font-size: 1rem; background-color: 
                            {% if resume_breakdown_data.sections.skills.percentage >= 80 %}#28a745
                            {% elif resume_breakdown_data.sections.skills.percentage >= 60 %}#ffc107
                            {% else %}#dc3545{% endif %};">
                            {{ resume_breakdown_data.sections.skills.percentage }}%
                        </span>
                    </div>
                    <p class="text-muted small mb-0 mt-2">{{ resume_breakdown_data.sections.skills.details }}</p>
                </div>
            </div>
            
            <!-- Projects -->
            <div class="col-md-6 mb-3">
                <div class="p-3" style="background-color: white; border-radius: 8px; border: 2px solid 
                    {% if resume_breakdown_data.sections.projects.percentage >= 80 %}#28a745
                    {% elif resume_breakdown_data.sections.projects.percentage >= 60 %}#ffc107
                    {% else %}#dc3545{% endif %};">
                    <h6 style="margin-bottom: 10px;">
                        <i class="bi bi-folder-fill"></i> Project Strength
                    </h6>
                    <div class="d-flex justify-content-between align-items-center">
                        <span style="font-size: 1.5rem; font-weight: bold;">
                            {{ resume_breakdown_data.sections.projects.score }}/{{ resume_breakdown_data.sections.projects.max_score }}
                        </span>
                        <span class="badge" style="font-size: 1rem; background-color: 
                            {% if resume_breakdown_data.sections.projects.percentage >= 80 %}#28a745
                            {% elif resume_breakdown_data.sections.projects.percentage >= 60 %}#ffc107
                            {% else %}#dc3545{% endif %};">
                            {{ resume_breakdown_data.sections.projects.percentage }}%
                        </span>
                    </div>
                    <p class="text-muted small mb-0 mt-2">{{ resume_breakdown_data.sections.projects.details }}</p>
                </div>
            </div>
            
            <!-- Extras -->
            <div class="col-md-6 mb-3">
                <div class="p-3" style="background-color: white; border-radius: 8px; border: 2px solid 
                    {% if resume_breakdown_data.sections.extras.percentage >= 80 %}#28a745
                    {% elif resume_breakdown_data.sections.extras.percentage >= 60 %}#ffc107
                    {% else %}#dc3545{% endif %};">
                    <h6 style="margin-bottom: 10px;">
                        <i class="bi bi-star-fill"></i> Overall Consistency
                    </h6>
                    <div class="d-flex justify-content-between align-items-center">
                        <span style="font-size: 1.5rem; font-weight: bold;">
                            {{ resume_breakdown_data.sections.extras.score }}/{{ resume_breakdown_data.sections.extras.max_score }}
                        </span>
                        <span class="badge" style="font-size: 1rem; background-color: 
                            {% if resume_breakdown_data.sections.extras.percentage >= 80 %}#28a745
                            {% elif resume_breakdown_data.sections.extras.percentage >= 60 %}#ffc107
                            {% else %}#dc3545{% endif %};">
                            {{ resume_breakdown_data.sections.extras.percentage }}%
                        </span>
                    </div>
                    <p class="text-muted small mb-0 mt-2">{{ resume_breakdown_data.sections.extras.details }}</p>
                </div>
            </div>
        </div>
        
        <!-- Strengths -->
        {% if resume_breakdown_data.strengths|length > 0 %}
        <div class="mb-3 p-3" style="background-color: #d4edda; border: 1px solid #c3e6cb; border-radius: 5px;">
            <h6 style="color: #155724; margin-bottom: 10px;">
                <i class="bi bi-check-circle-fill"></i> Your Strengths
            </h6>
            <ul class="mb-0" style="color: #155724;">
                {% for strength in resume_breakdown_data.strengths %}
                <li>{{ strength }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        
        <!-- Weaknesses -->
        {% if resume_breakdown_data.weaknesses|length > 0 %}
        <div class="mb-3 p-3" style="background-color: #f8d7da; border: 1px solid #f5c6cb; border-radius: 5px;">
            <h6 style="color: #721c24; margin-bottom: 10px;">
                <i class="bi bi-exclamation-triangle-fill"></i> Areas for Improvement
            </h6>
            <ul class="mb-0" style="color: #721c24;">
                {% for weakness in resume_breakdown_data.weaknesses %}
                <li>{{ weakness }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        
        <!-- Recommendations -->
        {% if resume_breakdown_data.recommendations|length > 0 %}
        <div class="p-3" style="background-color: #d1ecf1; border: 1px solid #bee5eb; border-radius: 5px;">
            <h6 style="color: #0c5460; margin-bottom: 10px;">
                <i class="bi bi-lightbulb-fill"></i> Recommendations
            </h6>
            <ul class="mb-0" style="color: #0c5460;">
                {% for recommendation in resume_breakdown_data.recommendations %}
                <li>{{ recommendation }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
        
        {% else %}
        <div class="text-center p-4" style="background-color: #fff3cd; border: 1px solid #ffc107; border-radius: 5px;">
            <i class="bi bi-info-circle" style="font-size: 2rem; color: #856404;"></i>
            <p class="mt-2 mb-0" style="color: #856404;">
                <strong>Breakdown analysis not available.</strong><br>
                <small>Resume data required for detailed breakdown.</small>
            </p>
        </div>
        {% endif %}
    </div>
    
    <!-- FEATURE 1: FINAL SUMMARY / VERDICT BOX -->
    <div class="report-section" style="background-color: #f0f8ff; border: 2px solid #007bff;">
        <div class="section-title">
            <i class="bi bi-clipboard-check"></i> Final Summary / Verdict
        </div>
        
        <div class="text-center">
            <div class="row">
                <div class="col-md-6 mb-3">
                    <strong>Resume Status:</strong><br>
                    <span class="
                        {% if readiness_status == 'Ready' %}text-success
                        {% elif readiness_status == 'Partially Ready' %}text-warning
                        {% else %}text-danger{% endif %}" style="font-size: 1.2rem; font-weight: bold;">
                        {{ readiness_status }}
                    </span>
                </div>
                <div class="col-md-6 mb-3">
                    <strong>Resume Score:</strong><br>
                    <span style="font-size: 1.2rem; font-weight: bold; color: #007bff;">
                        {{ resume_score }} / 100
                    </span>
                </div>
            </div>
            
            {% if job_title != "Not Selected" %}
            <div class="row">
                <div class="col-md-6 mb-3">
                    <strong>Job Fit Score:</strong><br>
                    <span style="font-size: 1.2rem; font-weight: bold; color: #007bff;">
                        {{ job_fit_score }} / 100
                    </span>
                </div>
                <div class="col-md-6 mb-3">
                    <strong>Missing Skills:</strong><br>
                    {% if missing_skills and missing_skills|length > 0 %}
                        <span style="font-size: 1.2rem; font-weight: bold; color: #dc3545;">
                            {{ missing_skills|length }} skill(s)
                        </span>
                    {% else %}
                        <span style="font-size: 1.2rem; font-weight: bold; color: #28a745;">
                            No missing skills
                        </span>
                    {% endif %}
                </div>
            </div>
            {% else %}
            <div class="row">
                <div class="col-12 mb-3">
                    <strong>Missing Skills:</strong><br>
                    {% if missing_skills and missing_skills|length > 0 %}
                        <span style="font-size: 1.2rem; font-weight: bold; color: #dc3545;">
                            {{ missing_skills|length }} skill(s)
                        </span>
                    {% else %}
                        <span style="font-size: 1.2rem; font-weight: bold; color: #28a745;">
                            No missing skills
                        </span>
                    {% endif %}
                </div>
            </div>
            {% endif %}
            
            <!-- FEATURE 5: CONFIDENCE LEVEL (TEXT ONLY) -->
            <div class="mt-3 p-3" style="background-color: white; border-radius: 8px; border: 1px solid #dee2e6;">
                <strong>Confidence Level:</strong><br>
                {% if readiness_status == "Ready" and job_fit_score >= 70 %}
                    <span style="font-size: 1.5rem; font-weight: bold; color: #28a745;">
                        <i class="bi bi-emoji-smile"></i> High
                    </span>
                {% elif readiness_status == "Partially Ready" %}
                    <span style="font-size: 1.5rem; font-weight: bold; color: #ffc107;">
                        <i class="bi bi-emoji-neutral"></i> Medium
                    </span>
                {% else %}
                    <span style="font-size: 1.5rem; font-weight: bold; color: #dc3545;">
                        <i class="bi bi-emoji-frown"></i> Low
                    </span>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- FEATURE 3: SKILL IMPROVEMENT TIPS (STATIC) -->
    {% if missing_skills and missing_skills|length > 0 %}
    <div class="report-section" style="background-color: #fff3cd; border: 2px solid #ffc107;">
        <div class="section-title" style="color: #856404;">
            <i class="bi bi-lightbulb"></i> Improvement Tips
        </div>
        
        <p><strong>To improve your skills and increase your job readiness, consider the following:</strong></p>
        
        <ul class="skills-list">
            <li>Practice core technical skills through online coding platforms</li>
            <li>Build small projects to demonstrate your abilities</li>
            <li>Revise fundamentals and strengthen your knowledge base</li>
            <li>Improve problem-solving skills with regular practice</li>
            <li>Take online courses or tutorials for missing skills</li>
            <li>Participate in hackathons and coding competitions</li>
            <li>Contribute to open-source projects on GitHub</li>
            <li>Network with professionals in your field</li>
        </ul>
        
        <p class="text-muted small mt-3" style="font-style: italic;">
            <i class="bi bi-info-circle"></i> These are general tips to help you improve. Focus on the missing skills listed above.
        </p>
    </div>
    {% endif %}
    
    <!-- Visual Analytics Section -->
    <div class="report-section">
        <div class="section-title">
            <i class="bi bi-bar-chart"></i> Visual Analytics
        </div>
        
        <p class="text-muted small" style="font-style: italic;">
            These charts are generated based on your resume evaluation and job analysis.
        </p>
        
        <!-- Bar Chart -->
        <div class="text-center mb-4">
            <h6>Job Availability Across Fields</h6>
            <img src="{{ url_for('static', filename='images/job_field_chart.png') }}" 
                 alt="Job Field Bar Chart" 
                 class="chart-image">
        </div>
        
        <!-- Pie Chart -->
        {% if missing_skills and missing_skills|length > 0 %}
        <div class="text-center mb-4">
            <h6>Skill Gap Impact Distribution</h6>
            <img src="{{ url_for('static', filename='images/skill_gap_chart.png') }}" 
                 alt="Skill Gap Pie Chart" 
                 class="chart-image">
        </div>
        
        <!-- Line Chart -->
        <div class="text-center mb-4">
            <h6>Current Skill Readiness Progress</h6>
            <img src="{{ url_for('static', filename='images/skill_readiness_chart.png') }}" 
                 alt="Skill Readiness Line Chart" 
                 class="chart-image">
        </div>
        {% endif %}
    </div>
    
    <!-- Footer -->
    <div class="text-center mt-4 text-muted">
        <p><small>Generated by NextHire.AI - Resume Evaluation System</small></p>
    </div>
    
    <!-- Print Instructions (hidden when printing) -->
    <div class="no-print">
        <div class="alert alert-info">
            <i class="bi bi-info-circle"></i>
            <strong>To download this report:</strong> Use your browser's Print function (Ctrl+P / Cmd+P) and select "Save as PDF"
        </div>
        
        <button type="button" onclick="window.print()" class="btn btn-primary btn-lg">
            <i class="bi bi-printer"></i> Print / Save as PDF
        </button>
        
        <button type="button" onclick="handleCloseReport()" class="btn btn-secondary btn-lg ms-2">
            <i class="bi bi-x-circle"></i> Close
        </button>
        
        <!-- FEATURE 4: RESET / START NEW EVALUATION BUTTON -->
        <button type="button" onclick="window.location.href='/reset-evaluation'" class="btn btn-success btn-lg ms-2">
            <i class="bi bi-arrow-clockwise"></i> Start New Evaluation
        </button>
    </div>
</div>

<script>
    /**
     * Handle Close Report button click
     * Safely navigates away from the report page
     */
    function handleCloseReport() {
        // CASE C: Try to close window if opened in new tab/window
        // This only works if window was opened by JavaScript
        if (window.opener) {
            window.close();
            return;
        }
        
        // CASE A: Navigate back if there's history
        if (window.history.length > 1) {
            window.history.back();
        } else {
            // Fallback: Redirect to home page
            window.location.href = '/';
        }
    }
</script>

</body>
</html>
